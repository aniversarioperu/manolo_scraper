# -*- coding: utf-8 -*-
import scrapy


class MtcSpider(scrapy.Spider):
    name = "mtc"
    allowed_domains = [
        "scrv-reporte.mtc.gob.pe",
        "peru.gob.pe",
        "www.peru.gob.pe",
    ]
    start_urls = (
        'http://scrv-reporte.mtc.gob.pe/',
    )

    def parse(self, response):
        event_validation = response.xpath('//input[@id="__EVENTVALIDATION"]/@value').extract()[0]
        print(">>>>>>> envent_validation", event_validation)
        print(">>>>>>> response_request cookies", response.request.cookies)
        url = 'http://scrv-reporte.mtc.gob.pe/'
        event_validation ="/wEdAE+/HFwLbDIFPwmyek9QJcSuG1KJ6Msbsi0i1ckC3NTFOyGS2y6kW/KpeLL4WPhLc/V229ZOGmCTHcNjw7pFBbJUsCNXWKlLc0bTvhgDodZKb0o2SRRhD4frB+dGoAvNtiEha49CL3MpW+DykQ0tl6TYpKSGSmb+Z4jsTtUrFNgV9ZxtVXZSqcl3VEesVNAiGMWyu5nsRz5zMTUVoX9tw9oPQUcMHsq7iiMn+lMQeZ7tLLkhuDMvOSn2jvcv+c3jlMxVdfySpFiYUv69ATrjOk988XTNRw5m8QaBzY2KLyCc9n1z1e/BRF3YnwjbUwlUgAANSq9O9Li7Hrv73IJW9PEh/7YUoNZyn5r7mWRR7lxeNuxFETes1YQCxskwgZm/9CvrF12hC6gE83gIpcBRd+jGd7kqsj1IJuKx4Dj5pTALnKoTCM+M2S5FJ9d6VJVtgQdkHCKHAmexnAXlEc5/8LAXDi/3ewfIlKLHD1SkGFipEkmrBj4JSzyP4K/3BvhTiNocjpVef93pTfZjAiMjWf3c7jhVZC/Y3eNoB4s8khBFeKCgNg41DizbC2XqPJojgaUk2cu0EvZ/AFSW11qT6ZKt5nOovL8NRD21P/qBniZrwrNwdf9bNKnZlGqq3uSUh7UB+E1pHnNZcN5UZmKI0uho9wiWPSO3LDrQ3H5VAJz/NRAEKv5Tr5ttJPDtG0r4ao9n2fvOX3XaivqVZiQwl5+N13Ti+dQ3WeXYKSlvGIBx2oxvXopcby7p67WU2aLEHH+5Ni7QkzPTM0BXwFmXJZ6I5SnSbJz7F/LbGKBU63NQV2OL5w+Bfupr8WZr0/vSud0AunKuwg1+le8022T6R9FFzCRI5WLwk7c9RfM+E9NDniADN+9pxPWWKhal8ctAQw+3U08jA553zjzgFQC2svlhFacyrjBOqpZjUrG1xbaTCKXCCqE7IPqLhHuMavkN4sIXxWYJAlNuNWkLmYeosVYpOkgFfQBis6Z50YVzx18dFDMttMVRvLyNGLV4dYdEJKoT7VVR5B2pU/MI88fUQ9ePIPNkuvVb3p/EssUDm6omTeYTfpFP3PlEPgNSzTdp4IA0Qf9X78/RzZuJS4l+8d50L2EFg9x3TB6qRE+RBE0RffyQk02ZpwCqFsy40Az1lBO0B4oRLs8au7jt0z+lydFZoX7aWwrHEufaP9H8tO+HfeM0oLYw81JSX/V3Jg3/I7eOGvMN7sVtosFvvGvIuCMLv3OxUqEh6Wxr2iNyHgdVhvJQda8aIITSZ2rO15Tpj7m097W9EnLGykZLrBExjG7AcRBapN9U/7QaXO1zZTM3mQBVkHxqOLAWs61/xoICqlg1URcOpJ4SaU0Q9SddOvjwsxhMdYLKCjzzM2ZJB4IV0CCahHKCOErTW0ntqM7so1gJV17uqVDA5H09u37ssora4n6juVT9ks6u6qz0YaMPqu2+XbCc2wZEPsg41WWzaUq5gJ1l44l9nYy2D1VCJMCq3+EZmAR0+Wm7sf5+G6r+p+iWX9hjwfa1KGkiyFNVcS11hHejmcAfNG2rHxkrmsUdM5Zb2Wkm3kh5uWI01bTM/d0gxKHTpnTFo2jY4Du4TmbGjCEklb2ANnYG4K4qBO769pt25GwsNPabSWD6rvgREv1y9VaAwObUS/oBXi4uH4Cwsp2VjsttZi/aZSXqIYH8oq0VDVPPdKpbovVje4vYhvOgd1BmAHVWQABFZC4ZsG0="
        yield scrapy.FormRequest(url,
                                   formdata={
                                       'ctl00$ScriptManager1': 'ctl00$ContentPlaceHolder$PanelVisita|ctl00$ContentPlaceHolder$btnConsultar',
                                       'ctl00$ContentPlaceHolder$ddlUnidad': '1',
                                       'ctl00$ContentPlaceHolder$ddlUnidadOrg': '1470',
                                       'ctl00$ContentPlaceHolder$txtDesde': '01/06/2015',
                                       'ctl00$ContentPlaceHolder$txtHasta': '09/07/2015',
                                       '__EVENTTARGET': '',
                                       '__EVENTARGUMENT': '',
                                       '__LASTFOCUS': '',
                                       '__VIEWSTATE': '/wEPDwUJOTY0NDUzMTIyD2QWAmYPZBYCAgMPZBYCAgkPZBYCAgEPZBYCZg9kFgICAQ9kFgICAQ9kFgJmD2QWAgIBD2QWCgIDDxBkZBYBAgFkAgsPEA8WBh4ORGF0YVZhbHVlRmllbGQFElNUUl9DRF9WSVNJVEFTX05FVx4NRGF0YVRleHRGaWVsZAUcU1RSX05PTUJSRV9ERVBFTkRFTkNJQV9OVUVWTx4LXyFEYXRhQm91bmRnZBAVQhEtLSBTRUxFQ0NJT05BUiAtLQVUT0RPUwtDQUZBRSAtIE1UQylDRU5UUk8gREUgT1BFUkFDSU9ORVMgREUgRU1FUkdFTkNJQSAtIENPRShDT01JU0lPTiBDT05TVUxUSVZBIERFIEFFUk9OQVVUSUNBIENJVklMKENPTUlTSU9OIENPTlNVTFRJVkEgREUgQUVST05BVVRJQ0EgQ0lWSUwzQ09NSVNJT04gREUgSU5WRVNUSUdBQ0lPTiBERSBBQ0NJREVOVEVTIERFIEFWSUFDSU9OM0NPTlNFSk8gQ09OU1VMVElWTyBERSBSQURJTyBZIFRFTEVWSVNJT04gLSBDT05DT1JUVhRERVNQQUNITyBNSU5JU1RFUklBTCpERVNQQUNITyBWSUNFTUlOSVNURVJJQUwgREUgQ09NVU5JQ0FDSU9ORVMnREVTUEFDSE8gVklDRU1JTklTVEVSSUFMIERFIFRSQU5TUE9SVEVTHkRJUkVDQ0lPTiBERSBBQ1RJVklEQUQgTkFWSUVSQRRESVJFQ0NJT04gREUgQ0FNSU5PUy1ESVJFQ0NJT04gREUgQ0VSVElGSUNBQ0lPTkVTIFkgQVVUT1JJWkFDSU9ORVMpRElSRUNDSU9OIERFIENJUkNVTEFDSU9OIFkgU0VHVVJJREFEIFZJQUwcRElSRUNDSU9OIERFIEVRVUlQTyBNRUNBTklDTyBESVJFQ0NJT04gREUgRVNUVURJT1MgRVNQRUNJQUxFUxpESVJFQ0NJT04gREUgRkVSUk9DQVJSSUxFUx9ESVJFQ0NJT04gREUgRklTQ0FMSVpBQ0lPTiBWSUFMHkRJUkVDQ0lPTiBERSBHRVNUSU9OIEFNQklFTlRBTBtESVJFQ0NJT04gREUgR0VTVElPTiBTT0NJQUwoRElSRUNDSU9OIERFIElORlJBRVNUUlVDVFVSQSBFIEhJRFJPVklBUx5ESVJFQ0NJT04gREUgTk9STUFUSVZJREFEIFZJQUwmRElSRUNDSU9OIERFIFJFR1VMQUNJT04gWSBOT1JNQVRJVklEQUQjRElSRUNDSU9OIERFIFJFR1VMQUNJT04gWSBQUk9NT0NJT04iRElSRUNDSU9OIERFIFNFR1VSSURBRCBBRVJPTkFVVElDQS5ESVJFQ0NJT04gREUgU0VSVklDSU9TIERFIFRSQU5TUE9SVEUgVEVSUkVTVFJFM0RJUkVDQ0lPTiBERSBTVVBFUlZJU0lPTiwgRklTQ0FMSVpBQ0lPTiBZIFNBTkNJT05FUyZESVJFQ0NJT04gR0VORVJBTCBERSBBRVJPTkFVVElDQSBDSVZJTC5ESVJFQ0NJT04gR0VORVJBTCBERSBBU1VOVE9TIFNPQ0lPLUFNQklFTlRBTEVTOURJUkVDQ0lPTiBHRU5FUkFMIERFIEFVVE9SSVpBQ0lPTkVTIEVOIFRFTEVDT01VTklDQUNJT05FUyxESVJFQ0NJT04gR0VORVJBTCBERSBDQU1JTk9TIFkgRkVSUk9DQVJSSUxFUzJESVJFQ0NJT04gR0VORVJBTCBERSBDT05DRVNJT05FUyBFTiBDT01VTklDQUNJT05FUy9ESVJFQ0NJT04gR0VORVJBTCBERSBDT05DRVNJT05FUyBFTiBUUkFOU1BPUlRFUzxESVJFQ0NJT04gR0VORVJBTCBERSBDT05UUk9MIFkgU1VQRVJWSVNJT04gREUgQ09NVU5JQ0FDSU9ORVNLRElSRUNDSU9OIEdFTkVSQUwgREUgUkVHVUxBQ0lPTiBZIEFTVU5UT1MgSU5URVJOQUNJT05BTEVTIERFIENPTVVOSUNBQ0lPTkVTKERJUkVDQ0lPTiBHRU5FUkFMIERFIFRSQU5TUE9SVEUgQUNVQVRJQ08pRElSRUNDSU9OIEdFTkVSQUwgREUgVFJBTlNQT1JURSBURVJSRVNUUkUUR0FCSU5FVEUgREUgQVNFU09SRVMZT0ZJQ0lOQSBERSBBQkFTVEVDSU1JRU5UTzVPRklDSU5BIERFIEFURU5DSU9OIEFMIENJVURBREFOTyBZIEdFU1RJT04gRE9DVU1FTlRBTEpPRklDSU5BIERFIENPTlRST0wgREVMIFNVQiBTRUNUT1IgQ09NVU5JQ0FDSU9ORVMgWSBBU1VOVE9TIEFETUlOSVNUUkFUSVZPUy1PRklDSU5BIERFIENPTlRST0wgREVMIFNVQiBTRUNUT1IgVFJBTlNQT1JURVMbT0ZJQ0lOQSBERSBERUZFTlNBIE5BQ0lPTkFMFk9GSUNJTkEgREUgRVNUQURJU1RJQ0ETT0ZJQ0lOQSBERSBGSU5BTlpBUx9PRklDSU5BIERFIElNQUdFTiBJTlNUSVRVQ0lPTkFMFk9GSUNJTkEgREUgSU5WRVJTSU9ORVMqT0ZJQ0lOQSBERSBPUkdBTklaQUNJw5NOIFkgUkFDSU9OQUxJWkFDSU9OFU9GSUNJTkEgREUgUEFUUklNT05JTxNPRklDSU5BIERFIFBFUlNPTkFMF09GSUNJTkEgREUgUExBTkVBTUlFTlRPPE9GSUNJTkEgREUgUExBTkVBTUlFTlRPIFkgU0VHVUlNSUVOVE8gREUgTUVESURBUyBDT1JSRUNUSVZBUxZPRklDSU5BIERFIFBSRVNVUFVFU1RPGU9GSUNJTkEgREUgUFJPWUVDVE9TIFBOVUQkT0ZJQ0lOQSBERSBURUNOT0xPR0lBIERFIElORk9STUFDSU9OIU9GSUNJTkEgR0VORVJBTCBERSBBRE1JTklTVFJBQ0lPTiRPRklDSU5BIEdFTkVSQUwgREUgQVNFU09SSUEgSlVSSURJQ0EtT0ZJQ0lOQSBHRU5FUkFMIERFIFBMQU5FQU1JRU5UTyBZIFBSRVNVUFVFU1RPH09SR0FOTyBERSBDT05UUk9MIElOU1RJVFVDSU9OQUwUUFJPQ1VSQURVUklBIFBVQkxJQ0FcUFJPWUVDVE8gRVNQRUNJQUwgREUgSU5GUkFFU1RSVUNUVVJBIERFIFRSQU5TUE9SVEUgREVTQ0VOVFJBTElaQURPIC0gUFJPVklBUyBERVNDRU5UUkFMSVpBRE9cUFJPWUVDVE8gRVNQRUNJQUwgREUgSU5GUkFFU1RSVUNUVVJBIERFIFRSQU5TUE9SVEUgREVTQ0VOVFJBTElaQURPIC0gUFJPVklBUyBERVNDRU5UUkFMSVpBRE8SU0VDUkVUQVJJQSBHRU5FUkFMM1NFQ1JFVEFSSUEgVEVDTklDQSBERSBHRVNUSU9OIERFIFJJRVNHTyBERSBERVNBU1RSRRxTRUNSRVRBUklBIFRFQ05JQ0EgREVMIEZJVEVMFUIAATEEMTQ3MAQxMTgxBDE0OTAEMTI2MAQxNDgwBDE0NTADMTEwAzEzMAMxMjAEMTEzMgQxMTQzBDExMjMEMTE1MwQxMTQ2BDExNDEEMTE0MgQxMTQ1BDExNjEEMTE2MgQxMTMxBDExNDQEMTE1MQQxMTI4BDExMjQEMTE1MgQxMTU0BDExMjAEMTE2MAQxMTcwBDExNDAEMTE5MAMxMjEEMTE4MAQxNDQwBDExMzAEMTE1MAMxNTAEMTEwMgMxNDIDMTYzAzE2MgMxNDEDMTk0BDExMDEDMTQ0AzE5MgMxOTUEMTEwNQQxMTA4AzE5MQMxNjEDMTkzBDE0NjAEMTEwNgQxMTAwAzE4MAMxOTADMTYwAzE3MAQxMjEwBDEyMjADMTQwAzE0NgMxMzIUKwNCZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZGQCEQ8PFgIeBFRleHQFCjA5LzA2LzIwMTVkZAIZDw8WAh8DBQowOS8wNy8yMDE1ZGQCIQ9kFgICAQ88KwARAgEQFgAWABYADBQrAABkGAIFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYEBSRjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIkYnRuRXhwb3J0YXIFI2N0bDAwJENvbnRlbnRQbGFjZUhvbGRlciRidG5SZWZyZXNoBSJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIkaWJ0bkRlc2RlBSJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIkaWJ0bkhhc3RhBSpjdGwwMCRDb250ZW50UGxhY2VIb2xkZXIkZ2R2UmVwb3J0ZVZpc2l0YXMPZ2TYu6rrGbGAoGKk8y6s/rJfjtS9/o3vQ6Scu3Hue3oN5g==',
                                       '__EVENTVALIDATION': event_validation,
                                       '__ASYNCPOST': 'true',
                                       'ctl00$ContentPlaceHolder$btnConsultar': 'Consultar',
                                   },
                                   callback=self.request_data)

    def request_data(self, response):
        with open('a.html', 'w') as handle:
            handle.write(response.body)
